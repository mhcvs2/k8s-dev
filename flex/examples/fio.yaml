apiVersion: apps/v1beta2
kind: Deployment
metadata:
  name: cephfs-flex-provisioner
  labels:
    k8s-app: cephfs-flex-provisioner
  namespace: kube-system
spec:
  selector:
    matchLabels:
      k8s-app: cephfs-flex-provisioner
  template:
    metadata:
      labels:
        k8s-app: cephfs-flex-provisioner
    spec:
      hostNetwork: true
      containers:
      - name: cephfs-flex-provisioner
        image: registry.bst-1.cns.bstjpc.com:5000/flex-provisioner:20180529
        imagePullPolicy: Always
        securityContext:
          privileged: true
        command:
          - bash
          - -c
          - "tail -f /dev/null"
        volumeMounts:
        - name: program
          mountPath: /go/src/k8s-dev
        - name: kubeconfig
          mountPath: /root/.kube
      volumes:
      - name: program
        hostPath:
          path: /data/lib/gopath/src/k8s-dev
      - name: kubeconfig
        hostPath:
          path: /root/.kube
      serviceAccountName: default
      nodeSelector:
        kubernetes.io/hostname: k8s-m1
